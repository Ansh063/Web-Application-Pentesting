

File Upload Vulnerability Basics : 

  - Attacker Abuses a file upload feature to upload malicious script 
  - Script is executed and allows for further attacks 
	- Webshell 
  - Filter Based on Content-Type,  extension names, Size etc 


1. Beating Content-Type Check in file Uploads : 

Content Type Check  :

  - Common Practise to check for Content-Types 
	- image/gif
 
  - Attaker can use an intercepting proxy and change the Content-Type to what is expected   

Note : To Bypass this Content Type Check just intercept the request and change the Content-Type to the favourable extention 


2. Bypassing Blacklists in File Upload : 

  Case Sensitive : 
  - Try to change the extension of file from .php  .PHP
 
  if this does not work :  
  
  Required Condition to Bypass : 
  
  - AllowOverride is turned on to All 
	- allows  .htaccess to work 

first we will upload .htaccess file to instruct the server to allow PHP file to run 

.htaccess file : 

	AddType application/x-httpd-php PHP
	// you can also use the different extention like : blah 
	// AddType application/x-httpd-php blah 

   
upload this file and then upload the backdoor with .PHP extention then it will run 

    

3. Bypassing Blacklists using PHPx : 

php3, php4, php5 

  - php 3/4/5 are allowed extension and supported by Default 


	

