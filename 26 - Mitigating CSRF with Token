
Mitigating CSRF with Tokens : 

What is the Problem with CSRF ? 

- Cookie is sent automatically with requests 
	- Attacker need not know the value of cookie 
- No other "session" or "operation" validation 
- How do we know the user is logged in and using the website ? 

Tokens: Per Session / Request 

- Solution to CSRF 

   - Identify the critical operation in the application 
 	- Basically URLs / API endpoint 
   - Each Critical Operation request must be accompained with a "token" 

   - Token is  
	- Long Random, Not Repeated for application lifetime 
	- Unique per session or even operation 
	- part of URL in GET
	- Hidden field in POST (form)
	- Attacker cannot know / Predict this token and hence cannot create request to exploit the 
	  operation 


what could go wrong ? Token Security 

 - Is the Token long enough ? 
 - Is it random enough ? entropy ? 
	- Should not be derived from known / Predictable data
 - Never repeated or reused ? 
 - Stored Insecurely
 	- GET requests in hostory files, Server logs etc
 - Is sent over a secure medium ? HTTPS ? 
	- Sniffing and MITM 
    



